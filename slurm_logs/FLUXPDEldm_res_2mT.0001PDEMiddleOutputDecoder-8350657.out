[[36m2025-04-08 11:11:36,940[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Enforcing tags! <cfg.extras.enforce_tags=True>[0m
[[36m2025-04-08 11:11:36,947[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Printing config tree with Rich! <cfg.extras.print_config=True>[0m
CONFIG
â”œâ”€â”€ data
â”‚   â””â”€â”€ _target_: src.data.downscaling_datamodule.DownscalingDataModule         
â”‚       data_dir: /usr/project/xtmp/par55/DiffScaler/data/                      
â”‚       static_vars:                                                            
â”‚         dtm_tif_file: /usr/project/xtmp/par55/DiffScaler/data//static_var/dtm_
â”‚         lc_tif_file: /usr/project/xtmp/par55/DiffScaler/data//static_var/land_
â”‚         lat_tif_file: /usr/project/xtmp/par55/DiffScaler/data//static_var/lat_
â”‚       target_vars:                                                            
â”‚         low_res:                                                              
â”‚         - 2mT                                                                 
â”‚         - PMSL                                                                
â”‚         - U10                                                                 
â”‚         - V10                                                                 
â”‚         - dp2mT                                                               
â”‚         - SST                                                                 
â”‚         - SNDPT                                                               
â”‚         - TP                                                                  
â”‚         - SSRadIn                                                             
â”‚         - Q850                                                                
â”‚         - T850                                                                
â”‚         - U850                                                                
â”‚         - V850                                                                
â”‚         - W850                                                                
â”‚         high_res:                                                             
â”‚         - 2mT                                                                 
â”‚       batch_size: 16                                                          
â”‚       num_workers: 2                                                          
â”‚       pin_memory: true                                                        
â”‚       crop_size: 512                                                          
â”‚       nn_lowres: false                                                        
â”‚                                                                               
â”œâ”€â”€ model
â”‚   â””â”€â”€ _target_: src.models.ldm_module.LatentDiffusion                         
â”‚       parameterization: v                                                     
â”‚       denoiser:                                                               
â”‚         _target_: src.models.components.ldm.denoiser.UNetModel                
â”‚         in_channels: 32                                                       
â”‚         model_channels: 256                                                   
â”‚         out_channels: 32                                                      
â”‚         num_res_blocks: 2                                                     
â”‚         attention_resolutions:                                                
â”‚         - 1                                                                   
â”‚         - 2                                                                   
â”‚         dims: 2                                                               
â”‚         channel_mult:                                                         
â”‚         - 1                                                                   
â”‚         - 2                                                                   
â”‚         - 4                                                                   
â”‚         num_heads: 8                                                          
â”‚         context_ch:                                                           
â”‚         - 256                                                                 
â”‚         - 512                                                                 
â”‚         - 1024                                                                
â”‚       autoencoder:                                                            
â”‚         _target_: src.models.ae_module.AutoencoderKL                          
â”‚         encoder:                                                              
â”‚           _target_: src.models.components.ae.SimpleConvEncoder                
â”‚           levels: 3                                                           
â”‚         decoder:                                                              
â”‚           _target_: src.models.components.ae.SimpleConvDecoder                
â”‚           levels: 3                                                           
â”‚         unet_regr:                                                            
â”‚           _target_: src.models.unet_module.UnetLitModule                      
â”‚           net:                                                                
â”‚             _target_: src.models.components.unet.DownscalingUnet              
â”‚             in_ch: 32                                                         
â”‚             out_ch: 1                                                         
â”‚             features:                                                         
â”‚             - 64                                                              
â”‚             - 128                                                             
â”‚             - 256                                                             
â”‚             - 512                                                             
â”‚           loss:                                                               
â”‚             _target_: torch.nn.MSELoss                                        
â”‚             reduction: mean                                                   
â”‚           optimizer: None                                                     
â”‚           ckpt_path: /usr/project/xtmp/par55/DiffScaler/pretrained_models/UNET
â”‚         ae_flag: residual                                                     
â”‚       context_encoder:                                                        
â”‚         _target_: src.models.components.ldm.conditioner.AFNOConditionerNetCasc
â”‚         autoencoder:                                                          
â”‚         - _target_: src.models.ae_module.AutoencoderKL                        
â”‚           encoder:                                                            
â”‚             _target_: src.models.components.ae.SimpleConvEncoder              
â”‚             in_dim: 18                                                        
â”‚             levels: 3                                                         
â”‚             ch_mult: 3                                                        
â”‚           decoder: None                                                       
â”‚         - _target_: src.models.ae_module.EncoderLRES                          
â”‚         train_autoenc: true                                                   
â”‚         cascade_depth: 3                                                      
â”‚         embed_dim:                                                            
â”‚         - 128                                                                 
â”‚         - 24                                                                  
â”‚         analysis_depth:                                                       
â”‚         - 4                                                                   
â”‚         - 4                                                                   
â”‚         afno_fusion: true                                                     
â”‚         input_size_ratios:                                                    
â”‚         - 1                                                                   
â”‚         - 1                                                                   
â”‚         embed_dim_out: 256                                                    
â”‚       lr: 0.0001                                                              
â”‚       ae_load_state_file: /usr/project/xtmp/par55/DiffScaler/pretrained_models
â”‚       pde_lambda: 0.1                                                         
â”‚       temp_pde_coef: 1.0e-05                                                  
â”‚       temp_energy_coef: 0                                                     
â”‚       pde_mode: temp                                                          
â”‚       trainable_parts:                                                        
â”‚       - denoiser.output_blocks                                                
â”‚       - autoencoder.decoder                                                   
â”‚       - denoiser.middle_block                                                 
â”‚                                                                               
â”œâ”€â”€ callbacks
â”‚   â””â”€â”€ model_checkpoint:                                                       
â”‚         _target_: lightning.pytorch.callbacks.ModelCheckpoint                 
â”‚         dirpath: /usr/project/xtmp/par55/DiffScaler/logs/train/runs/2025-04-08
â”‚         filename: epoch_{epoch:03d}                                           
â”‚         monitor: val/loss                                                     
â”‚         verbose: false                                                        
â”‚         save_last: true                                                       
â”‚         save_top_k: 3                                                         
â”‚         mode: min                                                             
â”‚         auto_insert_metric_name: false                                        
â”‚         save_weights_only: false                                              
â”‚         every_n_train_steps: null                                             
â”‚         train_time_interval: null                                             
â”‚         every_n_epochs: null                                                  
â”‚         save_on_train_epoch_end: null                                         
â”‚       early_stopping:                                                         
â”‚         _target_: lightning.pytorch.callbacks.EarlyStopping                   
â”‚         monitor: val/loss                                                     
â”‚         min_delta: 0.0                                                        
â”‚         patience: 5                                                           
â”‚         verbose: false                                                        
â”‚         mode: min                                                             
â”‚         strict: true                                                          
â”‚         check_finite: true                                                    
â”‚         stopping_threshold: null                                              
â”‚         divergence_threshold: null                                            
â”‚         check_on_train_epoch_end: null                                        
â”‚       model_summary:                                                          
â”‚         _target_: lightning.pytorch.callbacks.RichModelSummary                
â”‚         max_depth: -1                                                         
â”‚       rich_progress_bar:                                                      
â”‚         _target_: lightning.pytorch.callbacks.RichProgressBar                 
â”‚                                                                               
â”œâ”€â”€ logger
â”‚   â””â”€â”€ tensorboard:                                                            
â”‚         _target_: lightning.pytorch.loggers.tensorboard.TensorBoardLogger     
â”‚         save_dir: /usr/project/xtmp/par55/DiffScaler/logs/train/runs/2025-04-0
â”‚         name: null                                                            
â”‚         log_graph: false                                                      
â”‚         default_hp_metric: true                                               
â”‚         prefix: ''                                                            
â”‚                                                                               
â”œâ”€â”€ trainer
â”‚   â””â”€â”€ _target_: lightning.pytorch.trainer.Trainer                             
â”‚       default_root_dir: /usr/project/xtmp/par55/DiffScaler/logs/train/runs/202
â”‚       min_epochs: 1                                                           
â”‚       max_epochs: 10                                                          
â”‚       accelerator: gpu                                                        
â”‚       devices: 4                                                              
â”‚       strategy: ddp_find_unused_parameters_true                               
â”‚       check_val_every_n_epoch: 1                                              
â”‚       deterministic: false                                                    
â”‚                                                                               
â”œâ”€â”€ paths
â”‚   â””â”€â”€ root_dir: /usr/project/xtmp/par55/DiffScaler                            
â”‚       data_dir: /usr/project/xtmp/par55/DiffScaler/data/                      
â”‚       log_dir: /usr/project/xtmp/par55/DiffScaler/logs/                       
â”‚       output_dir: /usr/project/xtmp/par55/DiffScaler/logs/train/runs/2025-04-0
â”‚       work_dir: /usr/project/xtmp/par55/DiffScaler                            
â”‚       pretrained_models_dir: /usr/project/xtmp/par55/DiffScaler/pretrained_mod
â”‚                                                                               
â”œâ”€â”€ extras
â”‚   â””â”€â”€ ignore_warnings: false                                                  
â”‚       enforce_tags: true                                                      
â”‚       print_config: true                                                      
â”‚                                                                               
â”œâ”€â”€ task_name
â”‚   â””â”€â”€ train                                                                   
â”œâ”€â”€ tags
â”‚   â””â”€â”€ ['downscaling', 'ldm_res_2mT']                                          
â”œâ”€â”€ train
â”‚   â””â”€â”€ True                                                                    
â”œâ”€â”€ test
â”‚   â””â”€â”€ True                                                                    
â”œâ”€â”€ compile
â”‚   â””â”€â”€ False                                                                   
â”œâ”€â”€ ckpt_path
â”‚   â””â”€â”€ /usr/project/xtmp/par55/DiffScaler/pretrained_models/LDM_residual_2mT.ck
â”œâ”€â”€ seed
â”‚   â””â”€â”€ 42                                                                      
â”œâ”€â”€ optimized_metric
â”‚   â””â”€â”€ val/loss                                                                
â””â”€â”€ load_optimizer_state
    â””â”€â”€ False                                                                   
[[36m2025-04-08 11:11:37,041[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating datamodule <src.data.downscaling_datamodule.DownscalingDataModule>[0m
[[36m2025-04-08 11:11:37,477[0m][[34mnumexpr.utils[0m][[32mINFO[0m] - Note: NumExpr detected 48 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.[0m
[[36m2025-04-08 11:11:37,477[0m][[34mnumexpr.utils[0m][[32mINFO[0m] - NumExpr defaulting to 8 threads.[0m
[[36m2025-04-08 11:11:38,310[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating model <src.models.ldm_module.LatentDiffusion>[0m
Restored from /usr/project/xtmp/par55/DiffScaler/pretrained_models/UNET_2mT.ckpt with 0 missing and 0 unexpected keys
Unfreezing parameter: denoiser.middle_block.0.in_layers.2.weight
Unfreezing parameter: denoiser.middle_block.0.in_layers.2.bias
Unfreezing parameter: denoiser.middle_block.0.emb_layers.1.weight
Unfreezing parameter: denoiser.middle_block.0.emb_layers.1.bias
Unfreezing parameter: denoiser.middle_block.0.out_layers.3.weight
Unfreezing parameter: denoiser.middle_block.0.out_layers.3.bias
Unfreezing parameter: denoiser.middle_block.1.pre_proj.weight
Unfreezing parameter: denoiser.middle_block.1.pre_proj.bias
Unfreezing parameter: denoiser.middle_block.1.filter.w1
Unfreezing parameter: denoiser.middle_block.1.filter.b1
Unfreezing parameter: denoiser.middle_block.1.filter.w2
Unfreezing parameter: denoiser.middle_block.1.filter.b2
Unfreezing parameter: denoiser.middle_block.1.mlp.fc1.weight
Unfreezing parameter: denoiser.middle_block.1.mlp.fc1.bias
Unfreezing parameter: denoiser.middle_block.1.mlp.fc2.weight
Unfreezing parameter: denoiser.middle_block.1.mlp.fc2.bias
Unfreezing parameter: denoiser.middle_block.2.in_layers.2.weight
Unfreezing parameter: denoiser.middle_block.2.in_layers.2.bias
Unfreezing parameter: denoiser.middle_block.2.emb_layers.1.weight
Unfreezing parameter: denoiser.middle_block.2.emb_layers.1.bias
Unfreezing parameter: denoiser.middle_block.2.out_layers.3.weight
Unfreezing parameter: denoiser.middle_block.2.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.0.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.0.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.0.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.0.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.0.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.0.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.0.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.0.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.1.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.1.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.1.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.1.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.1.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.1.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.1.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.1.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.2.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.2.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.2.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.2.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.2.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.2.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.2.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.2.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.2.1.conv.weight
Unfreezing parameter: denoiser.output_blocks.2.1.conv.bias
Unfreezing parameter: denoiser.output_blocks.3.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.3.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.3.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.3.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.3.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.3.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.3.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.3.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.3.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.3.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.3.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.3.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.3.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.3.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.4.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.4.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.4.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.4.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.4.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.4.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.4.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.4.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.4.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.4.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.4.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.4.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.4.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.4.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.5.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.5.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.5.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.5.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.5.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.5.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.5.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.5.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.5.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.5.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.5.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.5.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.5.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.5.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.5.2.conv.weight
Unfreezing parameter: denoiser.output_blocks.5.2.conv.bias
Unfreezing parameter: denoiser.output_blocks.6.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.6.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.6.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.6.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.6.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.6.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.6.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.6.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.6.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.6.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.6.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.6.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.6.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.6.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.7.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.7.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.7.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.7.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.7.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.7.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.7.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.7.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.7.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.7.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.7.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.7.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.7.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.7.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.8.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.8.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.8.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.8.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.8.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.8.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.8.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.8.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.8.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.8.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.8.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.8.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.8.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.8.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc2.bias
Unfreezing parameter: autoencoder.decoder.net.0.weight
Unfreezing parameter: autoencoder.decoder.net.0.bias
Unfreezing parameter: autoencoder.decoder.net.1.proj.weight
Unfreezing parameter: autoencoder.decoder.net.1.proj.bias
Unfreezing parameter: autoencoder.decoder.net.1.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.1.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.1.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.1.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.1.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.1.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.1.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.1.norm2.bias
Unfreezing parameter: autoencoder.decoder.net.2.weight
Unfreezing parameter: autoencoder.decoder.net.2.bias
Unfreezing parameter: autoencoder.decoder.net.3.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.3.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.3.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.3.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.3.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.3.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.3.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.3.norm2.bias
Unfreezing parameter: autoencoder.decoder.net.4.weight
Unfreezing parameter: autoencoder.decoder.net.4.bias
Unfreezing parameter: autoencoder.decoder.net.5.proj.weight
Unfreezing parameter: autoencoder.decoder.net.5.proj.bias
Unfreezing parameter: autoencoder.decoder.net.5.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.5.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.5.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.5.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.5.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.5.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.5.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.5.norm2.bias
[[36m2025-04-08 11:11:43,635[0m][[34m__main__[0m][[32mINFO[0m] - Partial training mode: loading model weights from /usr/project/xtmp/par55/DiffScaler/pretrained_models/LDM_residual_2mT.ckpt without optimizer state.[0m
[[36m2025-04-08 11:11:56,837[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating callbacks...[0m
[[36m2025-04-08 11:11:56,838[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>[0m
[[36m2025-04-08 11:11:56,844[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>[0m
[[36m2025-04-08 11:11:56,845[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>[0m
[[36m2025-04-08 11:11:56,845[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>[0m
[[36m2025-04-08 11:11:56,847[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating loggers...[0m
[[36m2025-04-08 11:11:56,848[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating logger <lightning.pytorch.loggers.tensorboard.TensorBoardLogger>[0m
[[36m2025-04-08 11:11:56,849[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating trainer <lightning.pytorch.trainer.Trainer>[0m
[[36m2025-04-08 11:11:58,122[0m][[34m__main__[0m][[32mINFO[0m] - Logging hyperparameters![0m
[[36m2025-04-08 11:12:04,651[0m][[34m__main__[0m][[32mINFO[0m] - Starting training![0m
[[36m2025-04-08 11:12:20,480[0m][[34mnumexpr.utils[0m][[32mINFO[0m] - Note: NumExpr detected 48 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.[0m
[[36m2025-04-08 11:12:20,480[0m][[34mnumexpr.utils[0m][[32mINFO[0m] - NumExpr defaulting to 8 threads.[0m
[[36m2025-04-08 11:12:20,512[0m][[34mnumexpr.utils[0m][[32mINFO[0m] - Note: NumExpr detected 48 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.[0m
[[36m2025-04-08 11:12:20,513[0m][[34mnumexpr.utils[0m][[32mINFO[0m] - NumExpr defaulting to 8 threads.[0m
[[36m2025-04-08 11:12:20,575[0m][[34mnumexpr.utils[0m][[32mINFO[0m] - Note: NumExpr detected 48 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.[0m
[[36m2025-04-08 11:12:20,576[0m][[34mnumexpr.utils[0m][[32mINFO[0m] - NumExpr defaulting to 8 threads.[0m
Restored from /usr/project/xtmp/par55/DiffScaler/pretrained_models/UNET_2mT.ckpt with 0 missing and 0 unexpected keys
Unfreezing parameter: denoiser.output_blocks.0.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.0.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.0.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.0.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.0.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.0.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.0.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.0.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.1.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.1.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.1.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.1.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.1.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.1.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.1.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.1.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.2.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.2.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.2.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.2.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.2.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.2.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.2.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.2.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.2.1.conv.weight
Unfreezing parameter: denoiser.output_blocks.2.1.conv.bias
Unfreezing parameter: denoiser.output_blocks.3.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.3.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.3.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.3.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.3.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.3.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.3.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.3.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.3.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.3.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.3.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.3.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.3.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.3.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.4.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.4.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.4.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.4.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.4.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.4.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.4.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.4.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.4.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.4.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.4.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.4.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.4.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.4.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.5.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.5.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.5.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.5.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.5.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.5.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.5.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.5.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.5.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.5.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.5.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.5.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.5.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.5.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.5.2.conv.weight
Unfreezing parameter: denoiser.output_blocks.5.2.conv.bias
Unfreezing parameter: denoiser.output_blocks.6.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.6.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.6.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.6.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.6.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.6.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.6.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.6.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.6.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.6.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.6.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.6.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.6.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.6.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.7.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.7.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.7.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.7.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.7.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.7.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.7.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.7.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.7.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.7.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.7.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.7.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.7.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.7.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.8.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.8.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.8.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.8.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.8.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.8.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.8.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.8.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.8.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.8.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.8.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.8.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.8.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.8.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc2.bias
Unfreezing parameter: autoencoder.decoder.net.0.weight
Unfreezing parameter: autoencoder.decoder.net.0.bias
Unfreezing parameter: autoencoder.decoder.net.1.proj.weight
Unfreezing parameter: autoencoder.decoder.net.1.proj.bias
Unfreezing parameter: autoencoder.decoder.net.1.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.1.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.1.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.1.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.1.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.1.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.1.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.1.norm2.bias
Unfreezing parameter: autoencoder.decoder.net.2.weight
Unfreezing parameter: autoencoder.decoder.net.2.bias
Unfreezing parameter: autoencoder.decoder.net.3.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.3.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.3.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.3.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.3.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.3.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.3.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.3.norm2.bias
Unfreezing parameter: autoencoder.decoder.net.4.weight
Unfreezing parameter: autoencoder.decoder.net.4.bias
Unfreezing parameter: autoencoder.decoder.net.5.proj.weight
Unfreezing parameter: autoencoder.decoder.net.5.proj.bias
Unfreezing parameter: autoencoder.decoder.net.5.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.5.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.5.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.5.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.5.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.5.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.5.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.5.norm2.bias
[[36m2025-04-08 11:12:36,581[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Added key: store_based_barrier_key:1 to store for rank: 3[0m
Restored from /usr/project/xtmp/par55/DiffScaler/pretrained_models/UNET_2mT.ckpt with 0 missing and 0 unexpected keys
Unfreezing parameter: denoiser.output_blocks.0.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.0.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.0.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.0.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.0.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.0.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.0.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.0.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.1.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.1.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.1.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.1.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.1.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.1.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.1.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.1.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.2.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.2.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.2.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.2.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.2.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.2.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.2.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.2.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.2.1.conv.weight
Unfreezing parameter: denoiser.output_blocks.2.1.conv.bias
Unfreezing parameter: denoiser.output_blocks.3.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.3.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.3.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.3.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.3.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.3.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.3.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.3.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.3.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.3.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.3.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.3.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.3.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.3.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.4.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.4.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.4.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.4.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.4.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.4.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.4.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.4.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.4.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.4.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.4.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.4.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.4.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.4.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.5.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.5.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.5.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.5.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.5.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.5.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.5.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.5.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.5.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.5.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.5.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.5.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.5.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.5.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.5.2.conv.weight
Unfreezing parameter: denoiser.output_blocks.5.2.conv.bias
Unfreezing parameter: denoiser.output_blocks.6.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.6.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.6.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.6.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.6.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.6.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.6.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.6.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.6.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.6.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.6.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.6.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.6.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.6.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.7.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.7.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.7.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.7.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.7.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.7.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.7.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.7.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.7.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.7.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.7.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.7.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.7.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.7.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.8.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.8.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.8.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.8.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.8.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.8.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.8.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.8.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.8.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.8.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.8.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.8.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.8.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.8.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc2.bias
Unfreezing parameter: autoencoder.decoder.net.0.weight
Unfreezing parameter: autoencoder.decoder.net.0.bias
Unfreezing parameter: autoencoder.decoder.net.1.proj.weight
Unfreezing parameter: autoencoder.decoder.net.1.proj.bias
Unfreezing parameter: autoencoder.decoder.net.1.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.1.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.1.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.1.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.1.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.1.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.1.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.1.norm2.bias
Unfreezing parameter: autoencoder.decoder.net.2.weight
Unfreezing parameter: autoencoder.decoder.net.2.bias
Unfreezing parameter: autoencoder.decoder.net.3.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.3.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.3.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.3.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.3.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.3.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.3.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.3.norm2.bias
Unfreezing parameter: autoencoder.decoder.net.4.weight
Unfreezing parameter: autoencoder.decoder.net.4.bias
Unfreezing parameter: autoencoder.decoder.net.5.proj.weight
Unfreezing parameter: autoencoder.decoder.net.5.proj.bias
Unfreezing parameter: autoencoder.decoder.net.5.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.5.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.5.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.5.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.5.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.5.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.5.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.5.norm2.bias
[[36m2025-04-08 11:12:37,413[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Added key: store_based_barrier_key:1 to store for rank: 1[0m
Restored from /usr/project/xtmp/par55/DiffScaler/pretrained_models/UNET_2mT.ckpt with 0 missing and 0 unexpected keys
Unfreezing parameter: denoiser.output_blocks.0.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.0.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.0.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.0.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.0.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.0.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.0.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.0.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.1.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.1.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.1.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.1.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.1.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.1.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.1.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.1.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.2.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.2.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.2.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.2.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.2.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.2.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.2.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.2.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.2.1.conv.weight
Unfreezing parameter: denoiser.output_blocks.2.1.conv.bias
Unfreezing parameter: denoiser.output_blocks.3.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.3.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.3.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.3.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.3.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.3.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.3.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.3.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.3.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.3.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.3.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.3.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.3.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.3.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.3.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.4.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.4.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.4.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.4.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.4.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.4.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.4.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.4.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.4.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.4.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.4.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.4.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.4.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.4.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.4.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.5.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.5.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.5.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.5.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.5.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.5.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.5.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.5.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.5.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.5.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.5.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.5.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.5.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.5.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.5.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.5.2.conv.weight
Unfreezing parameter: denoiser.output_blocks.5.2.conv.bias
Unfreezing parameter: denoiser.output_blocks.6.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.6.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.6.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.6.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.6.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.6.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.6.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.6.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.6.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.6.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.6.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.6.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.6.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.6.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.6.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.7.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.7.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.7.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.7.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.7.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.7.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.7.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.7.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.7.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.7.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.7.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.7.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.7.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.7.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.7.1.mlp.fc2.bias
Unfreezing parameter: denoiser.output_blocks.8.0.in_layers.2.weight
Unfreezing parameter: denoiser.output_blocks.8.0.in_layers.2.bias
Unfreezing parameter: denoiser.output_blocks.8.0.emb_layers.1.weight
Unfreezing parameter: denoiser.output_blocks.8.0.emb_layers.1.bias
Unfreezing parameter: denoiser.output_blocks.8.0.out_layers.3.weight
Unfreezing parameter: denoiser.output_blocks.8.0.out_layers.3.bias
Unfreezing parameter: denoiser.output_blocks.8.0.skip_connection.weight
Unfreezing parameter: denoiser.output_blocks.8.0.skip_connection.bias
Unfreezing parameter: denoiser.output_blocks.8.1.pre_proj.weight
Unfreezing parameter: denoiser.output_blocks.8.1.pre_proj.bias
Unfreezing parameter: denoiser.output_blocks.8.1.filter.w1
Unfreezing parameter: denoiser.output_blocks.8.1.filter.b1
Unfreezing parameter: denoiser.output_blocks.8.1.filter.w2
Unfreezing parameter: denoiser.output_blocks.8.1.filter.b2
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc1.weight
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc1.bias
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc2.weight
Unfreezing parameter: denoiser.output_blocks.8.1.mlp.fc2.bias
Unfreezing parameter: autoencoder.decoder.net.0.weight
Unfreezing parameter: autoencoder.decoder.net.0.bias
Unfreezing parameter: autoencoder.decoder.net.1.proj.weight
Unfreezing parameter: autoencoder.decoder.net.1.proj.bias
Unfreezing parameter: autoencoder.decoder.net.1.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.1.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.1.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.1.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.1.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.1.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.1.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.1.norm2.bias
Unfreezing parameter: autoencoder.decoder.net.2.weight
Unfreezing parameter: autoencoder.decoder.net.2.bias
Unfreezing parameter: autoencoder.decoder.net.3.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.3.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.3.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.3.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.3.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.3.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.3.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.3.norm2.bias
Unfreezing parameter: autoencoder.decoder.net.4.weight
Unfreezing parameter: autoencoder.decoder.net.4.bias
Unfreezing parameter: autoencoder.decoder.net.5.proj.weight
Unfreezing parameter: autoencoder.decoder.net.5.proj.bias
Unfreezing parameter: autoencoder.decoder.net.5.conv1.weight
Unfreezing parameter: autoencoder.decoder.net.5.conv1.bias
Unfreezing parameter: autoencoder.decoder.net.5.conv2.weight
Unfreezing parameter: autoencoder.decoder.net.5.conv2.bias
Unfreezing parameter: autoencoder.decoder.net.5.norm1.weight
Unfreezing parameter: autoencoder.decoder.net.5.norm1.bias
Unfreezing parameter: autoencoder.decoder.net.5.norm2.weight
Unfreezing parameter: autoencoder.decoder.net.5.norm2.bias
[[36m2025-04-08 11:12:37,424[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Added key: store_based_barrier_key:1 to store for rank: 2[0m
[[36m2025-04-08 11:12:37,432[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Added key: store_based_barrier_key:1 to store for rank: 0[0m
[[36m2025-04-08 11:12:37,432[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.[0m
[[36m2025-04-08 11:12:37,434[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.[0m
[[36m2025-04-08 11:12:37,434[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.[0m
[[36m2025-04-08 11:12:37,440[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.[0m
[[36m2025-04-08 11:12:41,909[0m][[34msrc.utils.utils[0m][[31mERROR[0m] - [0m
Traceback (most recent call last):
  File "/usr/project/xtmp/par55/DiffScaler/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/usr/project/xtmp/par55/DiffScaler/src/train.py", line 68, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/users/par55/.local/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 529, in fit
    call._call_and_handle_interrupt(
  File "/home/users/par55/.local/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/users/par55/.local/lib/python3.10/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
  File "/home/users/par55/.local/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 568, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/users/par55/.local/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 949, in _run
    self.strategy.setup(self)
  File "/home/users/par55/.local/lib/python3.10/site-packages/lightning/pytorch/strategies/ddp.py", line 164, in setup
    self.configure_ddp()
  File "/home/users/par55/.local/lib/python3.10/site-packages/lightning/pytorch/strategies/ddp.py", line 269, in configure_ddp
    self.model = self._setup_model(_LightningModuleWrapperBase(self.model))
  File "/home/users/par55/.local/lib/python3.10/site-packages/lightning/pytorch/strategies/ddp.py", line 183, in _setup_model
    return DistributedDataParallel(module=model, device_ids=device_ids, **self._ddp_kwargs)
  File "/home/users/par55/.local/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 674, in __init__
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/home/users/par55/.local/lib/python3.10/site-packages/torch/distributed/utils.py", line 118, in _verify_param_shape_across_processes
    return dist._verify_params_across_processes(process_group, tensors, logger)
RuntimeError: DDP expects same model across all ranks, but Rank 0 has 192 params, while rank 1 has inconsistent 170 params.
[[36m2025-04-08 11:12:41,917[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Output dir: /usr/project/xtmp/par55/DiffScaler/logs/train/runs/2025-04-08_11-11-36[0m
